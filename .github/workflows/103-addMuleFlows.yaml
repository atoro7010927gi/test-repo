name: 103-addMuleFlows

on:
  workflow_dispatch:
    inputs:
      COMMIT_MESSAGE:
        required: true
        default: 'Mule flow was generated from maven archetype'
      ARCHETYPE_GROUP_ID:
        required: true
        default: 'jp.co.ctc.mulesoft'
      ARCHETYPE_ARTIFACT_ID:
        type: choice
        options: 
        - '!!!--- Please select ---!!!'
        - tpl0101-http-request-reply
        - tpl0102-http-async-request-reply
        - tpl0103-http-repeat-request-reply
        - tpl0201-sfdc-query
        - tpl0202-sfdc-async-query
        - tpl0203-sfdc-update
        - tpl0204-sfdc-async-update
        - tpl0301-rdb-request-reply
        - tpl0302-rdb-async-request-reply
        - tpl5101-data-migration
      ARCHETYPE_VERSION:
        required: true
        default: '1.0.0'
      MULE_APP_GROUP_ID:
        required: true
        default: 'jp.co.ctc.mulesoft'
      MULE_APP_VERSION:
        required: true
        default: '1.0.0-SNAPSHOT'
      FLOW_NO:
        required: true
        default: '1'
      FLOW_NAME:
        required: true
        default: 'sample-flow'

jobs:
  # Generate Mule app from maven archetype
  call-generateMuleAppWorkflow:
    if: startsWith(github.ref, 'refs/heads/dev/') || startsWith(github.ref, 'refs/heads/develop/')
    uses: ./.github/workflows/201-generateMuleApp.yaml
    with:
      BRANCH_NAME:  ${{ github.ref_name }}
      COMMIT_MESSAGE: ${{ github.event.inputs.COMMIT_MESSAGE }}
      ARCHETYPE_GROUP_ID: ${{ github.event.inputs.ARCHETYPE_GROUP_ID }}
      ARCHETYPE_ARTIFACT_ID: ${{ github.event.inputs.ARCHETYPE_ARTIFACT_ID }}
      ARCHETYPE_VERSION: ${{ github.event.inputs.ARCHETYPE_VERSION }}
      MULE_APP_GROUP_ID: ${{ github.event.inputs.MULE_APP_GROUP_ID }}
      MULE_APP_VERSION: ${{ github.event.inputs.MULE_APP_VERSION }}
      FLOW_NO: ${{ github.event.inputs.FLOW_NO }}
      FLOW_NAME: ${{ github.event.inputs.FLOW_NAME }}
